name: Java CI
on: 
  push:
      branches:
        - develop
        - '**/feature.*/'
        - master
jobs:
    job1:
      name: my job for produce package
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v2 # The checkout step downloads a copy of your repository on the runner.
        - name: set up node
          uses: actions/setup-node@v1
        - name: Install bats
          run: npm install -g bats
        - name: execute a cmd
          run: bats -v
        - name: Set up JDK 1.8
          uses: actions/setup-java@v1
          with:
            java-version: 1.8
        - name: Build with Maven
          run: mvn -B package --file pom.xml
    job2:
      name: testing job on multiple os
      runs-on: ${{ matrix.os }}
      strategy:
          matrix:
            os: [ubuntu-16.04, ubuntu-18.04]
            node: [6, 8, 10]
      steps:
        - uses: actions/checkout@v2 # The checkout step downloads a copy of your repository on the runner.
        - uses: actions/setup-node@v1
          with:
            node-version: ${{ matrix.node }}
        - name: Set up JDK 1.8
          uses: actions/setup-java@v1 
          with:
            java-version: 1.8
            architecture: x64
        - name: Test with Maven
          run: mvn -B test --file pom.xml

    job3:
      name: Building and testing your code
      needs: job1
      runs-on: ubuntu-20.04
      steps:
        - uses: actions/checkout@v2  # The checkout step downloads a copy of your repository on the runner.
        - uses: actions/setup-java@v1
          with:
            java-version: 1.8
        - name: Run the Maven verify phase
          run: mvn -B verify --file pom-ci.xml
      



    
